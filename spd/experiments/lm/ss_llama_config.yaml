C: 1200
batch_size: 64
ci_alive_threshold: 0.0
ci_fn_hidden_dims:
- 1000
ci_fn_type: shared_mlp
eval_batch_size: 64
eval_freq: 1000
eval_metric_configs:
- classname: CIHistograms
  n_batches_accum: 5
- classname: ComponentActivationDensity
- classname: StochasticReconSubsetCEAndKL
  include_patterns:
    layer_0_only:
    - model.layers.0.*
    layer_1_only:
    - model.layers.1.*
    layer_2_only:
    - model.layers.2.*
    layer_3_only:
    - model.layers.3.*
    mlp_only:
    - 'model.layers.*.mlp.*'
    attention_only:
    - 'model.layers.*.self_attn.*'
  exclude_patterns:
    all_but_layer_0:
    - model.layers.0.*
    all_but_layer_1:
    - model.layers.1.*
    all_but_layer_2:
    - model.layers.2.*
    all_but_layer_3:
    - model.layers.3.*
- classname: CI_L0
  groups:
    layer_0:
    - model.layers.0.*
    layer_1:
    - model.layers.1.*
    layer_2:
    - model.layers.2.*
    layer_3:
    - model.layers.3.*
- classname: CEandKLLosses
  rounding_threshold: 0.0
- classname: CIMeanPerComponent
- classname: StochasticHiddenActsReconLoss
  coeff: null
- classname: PGDReconLoss
  coeff: null
  init: random
  mask_scope: shared_across_batch
  n_steps: 20
  step_size: 0.1
faithfulness_warmup_lr: 0.001
faithfulness_warmup_steps: 0
faithfulness_warmup_weight_decay: 0.0
gradient_accumulation_steps: 1
identity_module_patterns: null
loss_metric_configs:
- classname: ImportanceMinimalityLoss
  coeff: 0.002
  eps: 1.0e-12
  p_anneal_end_frac: 1.0
  p_anneal_final_p: 0.3
  p_anneal_start_frac: 0.0
  pnorm: 2.0
- classname: StochasticReconSubsetLoss
  coeff: 1.0
lr: 0.0002
lr_exponential_halflife: null
lr_schedule: cosine
lr_warmup_pct: 0.0
n_eval_steps: 5
n_examples_until_dead: 1368400
n_mask_samples: 1
out_dir: null
output_loss_type: kl
pretrained_model_class: transformers.LlamaForCausalLM
pretrained_model_name: SimpleStories/SimpleStories-1.25M
pretrained_model_output_attr: logits
pretrained_model_path: null
sampling: continuous
save_freq: null
seed: 0
sigmoid_type: leaky_hard
slow_eval_freq: 10000
slow_eval_on_first_step: true
steps: 200000
target_module_patterns:
- model.layers.*.mlp.gate_proj
- model.layers.*.mlp.down_proj
- model.layers.*.mlp.up_proj
- model.layers.*.self_attn.q_proj
- model.layers.*.self_attn.k_proj
- model.layers.*.self_attn.v_proj
- model.layers.*.self_attn.o_proj
task_config:
  buffer_size: 1000
  column_name: story
  dataset_name: SimpleStories/SimpleStories
  eval_data_split: test
  is_tokenized: false
  max_seq_len: 512
  shuffle_each_epoch: true
  streaming: false
  task_name: lm
  train_data_split: train
tokenizer_name: SimpleStories/SimpleStories-1.25M
train_log_freq: 200
use_delta_component: true
wandb_project: spd
wandb_run_name: null
wandb_run_name_prefix: ''