<!DOCTYPE html>
<html>
<head>
    <title>Cluster Details</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/notif.css">
    <style>
        .model-view-cell {
            width: 200px;
            min-height: 60px;
        }

        .model-view-cell .layer-block {
            margin: 1px 0;
            display: flex;
            flex-direction: column;
            gap: 1px;
        }

        .model-view-cell .module-group {
            display: flex;
            gap: 1px;
            border: 1px solid #ddd;
            padding: 1px;
        }

        .model-view-cell .module-cell {
            width: 8px;
            height: 8px;
            border-radius: 1px;
            cursor: pointer;
        }

        #modelView .layer-block {
            margin: 2px 0;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        #modelView .module-group {
            display: flex;
            gap: 2px;
            border: 1px solid #ddd;
            padding: 2px;
            background: #fafafa;
        }

        #modelView .module-cell {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div>
        <a href="index.html">‚Üê Back to cluster list</a>
        <h1 id="clusterTitle">Cluster Details</h1>
    </div>
    
    <div id="components">
        <h2>Components (<span id="componentCount">0</span>)</h2>

        <div style="display: flex; gap: 20px; align-items: start;">
            <div id="modelView" style="flex-shrink: 0;">
                <!-- Model visualization will be inserted here -->
            </div>
            <div id="componentsTable" style="flex-grow: 1;"></div>
        </div>
    </div>

    <div id="tokenActivations" style="display: none;">
        <h2>Token Activation Statistics</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total Unique Tokens</div>
                <div class="stat-value" id="totalUniqueTokens">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Activations</div>
                <div class="stat-value" id="totalActivations">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Entropy</div>
                <div class="stat-value" id="entropy">-</div>
                <div class="stat-help">Higher = more diverse token distribution</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Concentration Ratio</div>
                <div class="stat-value" id="concentrationRatio">-</div>
                <div class="stat-help">Fraction of activations in top 10% tokens</div>
            </div>
        </div>

        <h3>Most Frequently Activated Tokens</h3>
        <div id="topTokensTable"></div>
    </div>

    <div id="samples">
        <h2>Top Text Samples</h2>
        <table id="samplesTable">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Text</th>
                </tr>
            </thead>
            <tbody id="samplesTableBody">
            </tbody>
        </table>
    </div>
    
    <div id="loading">Loading cluster data...</div>
    <div id="tooltip" style="display: none; position: absolute; background: #333; color: white; padding: 8px; border-radius: 4px; white-space: pre; z-index: 1000; pointer-events: none;"></div>

    <script src="js/util/notif.js"></script>
    <script src="js/util/config.js"></script>
    <script src="js/util/table.js"></script>
    <script src="js/util/sparklines.js"></script>
    <script src="js/util/array.js"></script>
    <script src="js/util/ColorUtil.js"></script>
    <script src="js/model-visualization.js"></script>
    <script src="js/token-display.js"></script>
    <script src="js/cluster-detail.js"></script>
</body>
</html>